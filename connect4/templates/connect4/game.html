{% extends "connect4/base_with_nav.html" %}
{% block title %} Play Game {% endblock %}

{% block page-name %}
{% endblock %}

{% block content %}

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        {% load static %}
        <link href="{% static 'connect4/css/custom.css' %}" rel="stylesheet" type="text/css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="/static/connect4/js/base.js"></script>
    </head>

    <body>
        {% csrf_token %}
        <div class="container-fluid">
            <div class="row h-100 pad-0" id="main_container_row">
                <div class="col-2 pad-0" id="players_div">
                    <div class="row h-35 pad-0" id="opponent_div">
                        <div class="col-12 pad-0-col">
                            <img src="https://www.highlandernews.org/wp-content/uploads/radar.legobatman.warnerbros.pictures-560x420.jpg" class="game-image border border-p1" alt="dhruvv">
                        </div>
                    </div>
                    <div class="row h-30 d-flex flex-wrap align-items-center" id="timer_div">
                        <div class="alert alert-info h-30 w-100 mx-auto d-block">Timer</div>
                    </div>
                    <div class="row h-35 align-items-end pad-0" id="player_div">
                        <div class="col-12 pad-0-col">
                            <img src="https://www.gannett-cdn.com/-mm-/0d332f7c34a8dfd2c9757779acdf9307a8ac4b55/c=634-0-2230-1200&r=x513&c=680x510/local/-/media/2016/07/19/USATODAY/USATODAY/636045484596074541-LGB-CC-0001.jpg"
                            class="game-image border border-p2" alt="devikas">
                        </div>
                    </div>
                </div>

                <div class="col-7 pad-0-col" id="players_board_div">
                    <div class="row h-10 pad-0">
                        <div class="col-12 pad-0-col">
                            <div class="row name p1bg pad-0-col"><i>{{opponent.user.username}}</i></div>
                            <div class="row info p1bg pad-0-col">{{opponent.user.get_full_name}}</div>
                            <div class="row"></div>
                        </div>
                    </div>
                    {% load static %}
                    <div class="row h-80 pad-0" id="board_div">
                        <div class="col-1 pad-0-col"></div>
                        <div class="col-11 pad-0-col">
                            <div class="row h-8 pad-0"></div>
                            <div class="row h-12 pad-0">
                                <div class="col-2 pad-0"></div>
                                <div class="col-1 pad-0 d-flex flex-wrap align-items-center" onclick="add_disc(0)"><i class="fas fa-circle fa-4x mx-auto top-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex flex-wrap align-items-center" onclick="add_disc(1)"><i class="fas fa-circle fa-4x mx-auto top-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex flex-wrap align-items-center" onclick="add_disc(2)"><i class="fas fa-circle fa-4x mx-auto top-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex flex-wrap align-items-center" onclick="add_disc(3)"><i class="fas fa-circle fa-4x mx-auto top-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex flex-wrap align-items-center" onclick="add_disc(4)"><i class="fas fa-circle fa-4x mx-auto top-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex flex-wrap align-items-center" onclick="add_disc(5)"><i class="fas fa-circle fa-4x mx-auto top-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex flex-wrap align-items-center" onclick="add_disc(6)"><i class="fas fa-circle fa-4x mx-auto top-disc pad-0"></i></div>                                
                            </div>
                            <div class="row h-12 pad-0">
                                <div class="col-2 pad-0"></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center h-100 round-top-left" onclick="add_disc(0)"><i id="disc_50" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(1)"><i id="disc_51" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(2)"><i id="disc_52" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(3)"><i id="disc_53" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(4)"><i id="disc_54" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(5)"><i id="disc_55" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center round-top-right" onclick="add_disc(6)"><i id="disc_56" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>                               
                            </div>                            

                            <div class="row h-12 pad-0">
                                <div class="col-2 pad-0"></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center h-100" onclick="add_disc(0)"><i id="disc_40" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(1)"><i id="disc_41" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(2)"><i id="disc_42" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(3)"><i id="disc_43" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(4)"><i id="disc_44" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(5)"><i id="disc_45" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(6)"><i id="disc_46" class="fas fa-circle fa-4x mx-auto board-disc pad-0"></i></div>                                
                            </div>
                            <div class="row h-12 pad-0">
                                <div class="col-2 pad-0"></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center h-100" onclick="add_disc(0)"><i id="disc_30" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(1)"><i id="disc_31" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(2)"><i id="disc_32" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(3)"><i id="disc_33" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(4)"><i id="disc_34" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(5)"><i id="disc_35" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(6)"><i id="disc_36" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>                                
                            </div>
                            <div class="row h-12 pad-0">
                                <div class="col-2 pad-0"></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center h-100" onclick="add_disc(0)"><i id="disc_20" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(1)"><i id="disc_21" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(2)"><i id="disc_22" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(3)"><i id="disc_23" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(4)"><i id="disc_24" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(5)"><i id="disc_25" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(6)"><i id="disc_26" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>                                
                            </div>
                            <div class="row h-12 pad-0">
                                <div class="col-2 pad-0"></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center h-100" onclick="add_disc(0)"><i id="disc_10" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(1)"><i id="disc_11" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(2)"><i id="disc_12" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(3)"><i id="disc_13" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(4)"><i id="disc_14" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(5)"><i id="disc_15" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(6)"><i id="disc_16" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>                                
                            </div>
                            <div class="row h-12 pad-0">
                                <div class="col-2 pad-0"></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center h-100 round-bottom-left" onclick="add_disc(0)"><i id="disc_00" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(1)"><i id="disc_01" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(2)"><i id="disc_02" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(3)"><i id="disc_03" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(4)"><i id="disc_04" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center" onclick="add_disc(5)"><i id="disc_05" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>
                                <div class="col-1 pad-0 d-flex bg-warning flex-wrap align-items-center round-bottom-right" onclick="add_disc(6)"><i id="disc_06" class="fas fa-circle fa-4x mx-auto board-disc"></i></div>                                
                            </div>
                            <div class="row h-8 pad-0"></div>                            
                        </div>                        
                    </div>
                    <div class="row h-10 align-items-end pad-0">
                        <div class="col-12 pad-0-col">
                            <div class="row name p2bg pad-0-col"><i>{{selfplayer.user.username}}</i></div>
                            <div class="row p2bg info pad-0-col">{{selfplayer.user.get_full_name}}</div>
                        </div>
                    </div>
                </div>

                <div class="col-3 card bg-transparent card-body" id="chat_div">
                    <div class="row"></div>
                </div>
            </div>
        </div>
    </body>
    <script>
        let myUserName = "{{ request.user.username }}"
        let playerId = "{{ request.user.id }}"
        let gameId = "{{ game_id }}";
        let filled = [-1,-1,-1,-1, -1, -1, -1]
        function add_disc(col) {
            if (filled[col] < 5) {
                filled[col] += 1
                document.getElementById("disc_"+filled[col].toString()+col.toString()).className = "fas fa-circle fa-4x mx-auto filled-disc pad-0";                                 
            }
            playTurn(gameId, playerId, col);
        }
        
        window.setInterval(pollGame, 10000, gameId);
    </script>

{% endblock %}